# 缓存

- Web 缓存是可以自动保存常见文档副本的 HTTP 设备。当 Web 请求抵达缓存时，如果本地有“已缓存的”副本，就可以从本地存储设备而不是原始服务器中提取这个文档。使用缓存有下列优点：
    - 缓存减少了冗余的数据传输，节省了你的网络费用；
    - 缓存缓解了网络瓶颈的问题，不需要更多带宽就能够更快地加载页面；
    - 缓存降低了对原始服务器的要求，服务器可以更快地响应，避免过载的出现；
    - 缓存降低了距离时延，因为从较远的地方加载页面会更慢一些；

## 缓存的处理步骤

- 接收 —— 缓存从网络中读取抵达的请求报文；
- 解析 —— 缓存对报文进行解析，提取出 URL 和各种首部；
- 查询 —— 缓存查看是否有本地副本可用，如果没有，就获取一份副本（并将其保存在本地）；
- 新鲜度检测 —— 缓存查看已缓存副本是否足够新鲜，如果不是，就询问服务器是否有任何更新；
- 创建响应 —— 缓存会用新的首部和已缓存的主体来创建一条响应报文；
- 发送 —— 缓存通过网络将响应发挥给客户端；
- 日志 —— 缓存可选地创建一个日志文件条目来描述这个事务；

## 缓存首部字段

- Cache-Control：max-age
    - max-age 值定义了文档的最大使用期 —— 从第一次生成文档到文档不再新鲜、无法使用位置，最大的合法生存时间；
- Expires
    - 指定一个绝对的过期日期；如果过期日期已经过了，就说明文档不再新鲜了；
- If-Modified-Since:<date>
    - 如果从指定日期之后文档被修改过了，就执行请求的方法。可以与 Last-Modified 服务器响应首部配合使用，只有在内容被修改后与已缓存版本有所不同时才去获取内容。
- If-None-Match:<tags>
    - 服务器可以为文档提供特殊的标签（ETag），而不是将其与最近修改日期相匹配，这些标签就像序列号一样。如果已缓存标签与服务器文档中的标签有所不同，If-None-Match 首部就会执行所请求的方法；